<%- include('partials/header', { title: 'Home â€¢ Parameter Pollution Lab' }) %>

<div class="row g-4">
  <div class="col-12 col-lg-8">
    <div class="card">
      <div class="card-header"><strong>Welcome</strong></div>
      <div class="card-body">
        <p class="mb-3">Explore prototype/parameter pollution with <code>lodash.merge</code> and an EJS SSTI chain.</p>
        <ul class="mb-0">
          <li>Try <a href="/search?filters[q]=hello&filters[tags][]=x&filters[tags][]=y&page=2">/search</a> to see query merging of nested defaults.</li>
          <li>Profile updates use <code>POST /update-profile</code> (intentionally unsafe for the lab).</li>
        </ul>
      </div>
    </div>
  </div>
  <div class="col-12 col-lg-4">
    <div class="card">
      <div class="card-header"><strong>Quick Links</strong></div>
      <div class="card-body d-grid gap-2">
        <% if (!currentUser) { %>
          <a class="btn btn-primary" href="/auth/login">Login</a>
          <a class="btn btn-outline-light" href="/auth/register">Register</a>
        <% } else { %>
          <a class="btn btn-primary" href="/dashboard">Dashboard</a>
          <a class="btn btn-outline-light" href="/messages">Messages</a>
          <a class="btn btn-outline-light" href="/upload">Upload</a>
        <% } %>
        <a class="btn btn-outline-light" href="/admin">Admin</a>
      </div>
    </div>
  </div>
  <div class="col-12">
    <pre class="mt-3">Tip: restart the server to clear in-memory users/messages and remove any prototype pollution.</pre>
  </div>
</div>

<%- include('partials/footer') %>
